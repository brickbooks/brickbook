<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Booking-Off – BrickBook</title>

    <style>
        :root {
            --blue: #1B73E8;
            --charcoal: #2D2D2D;
            --lightgrey: #F5F7FA;
            --white: #FFFFFF;
        }

        /* GENERAL */
        body {
            margin: 0;
            background: var(--lightgrey);
            font-family: 'Inter', Arial, sans-serif;
            color: var(--charcoal);
        }

        /* HEADER RESTORED EXACTLY */
        header {
            background: var(--white);
            padding: 18px 24px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid #E5EAF0;
            position: sticky;
            top: 0;
            z-index: 200;
        }
        .logo { font-size: 20px; font-weight: 700; }
        nav a {
            margin-left: 20px;
            text-decoration: none;
            color: var(--charcoal);
            font-weight: 600;
        }
        nav a:hover { color: var(--blue); }

        .wrapper {
            max-width: 1100px;
            margin: 0 auto;
            padding: 30px 20px 80px;
        }

        h1 { font-size: 28px; font-weight: 800; }
        .subtitle { color: #666; margin-bottom: 20px; }

        /* PLOT CARDS */
        .plot-card {
            background: white;
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 22px;
            box-shadow: 0 4px 14px rgba(0,0,0,0.05);
            max-width: 700px;
            position: relative;
        }

        /* Delete button */
        .delete-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #ffe2e2;
            color: #b00000;
            border: 1px solid #ffb3b3;
            padding: 4px 10px;
            font-size: 12px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 700;
        }

        .plot-title input {
            width: 100px;
            padding: 6px;
            border-radius: 6px;
            border: 1px solid #dcdcdc;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 12px;
        }

        thead { background: #e7efff; }
        th, td { padding: 6px 8px; border-bottom: 1px solid #e3e3e3; }

        /* Inputs & remove spinner */
        input[type="number"], input[type="text"] {
            width: 100%;
            padding: 6px;
            border-radius: 6px;
            border: 1px solid #ccc;
            box-sizing: border-box;
        }
        input[type="number"]::-webkit-inner-spin-button,
        input[type="number"]::-webkit-outer-spin-button { -webkit-appearance: none; }
        input[type="number"] { -moz-appearance: textfield; }

        /* Totals */
        .plot-total-box {
            text-align: right;
            font-size: 16px;
            font-weight: 700;
            margin-top: 8px;
        }

        .grand-total-box {
            text-align: right;
            font-size: 22px;
            font-weight: 800;
            margin: 40px 0;
        }

        /* Buttons */
        .btn-secondary {
            padding: 10px 18px;
            background: #eef2ff;
            color: var(--blue);
            border: 1px solid #c5d4ff;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            margin-bottom: 20px;
        }

        .btn-primary {
            padding: 12px 20px;
            background: var(--blue);
            color: white;
            border-radius: 10px;
            border: none;
            cursor: pointer;
            font-weight: 700;
            float: right;
        }

        /* SQUAD SPLIT */
        .split-card {
            background: white;
            padding: 20px;
            margin-top: 35px;
            border-radius: 16px;
            max-width: 700px;
            box-shadow: 0 4px 14px rgba(0,0,0,0.05);
        }

        .split-header {
            font-size: 20px;
            font-weight: 800;
            margin-bottom: 15px;
        }

        .split-row {
            display: grid;
            grid-template-columns: 1fr 90px 120px 140px;
            gap: 10px;
            margin-bottom: 8px;
            align-items: center;
        }

        .final-split-total {
            text-align: right;
            font-size: 20px;
            font-weight: 800;
            margin-top: 20px;
        }
/* -----------------------------------------
   MOBILE VERSION IMPROVEMENTS (≤ 768px)
----------------------------------------- */
@media (max-width: 768px) {

    .wrapper {
        padding: 15px;
    }

    /* HEADER */
    header {
        padding: 14px 16px;
    }
    nav a {
        margin-left: 12px;
        font-size: 14px;
    }

    /* PLOT CARD */
    .plot-card {
        padding: 14px;
        margin-bottom: 18px;
        max-width: 100%;
    }

    .plot-title {
        font-size: 16px;
        display: flex;
        align-items: center;
        gap: 6px;
    }
    .plot-title input {
        width: 70px;
        padding: 4px 6px;
        font-size: 14px;
    }

    table {
        font-size: 13px;
    }
    th, td {
        padding: 6px 5px;
    }

    /* Delete button */
    .delete-btn {
        top: 8px;
        right: 8px;
        padding: 3px 8px;
        font-size: 11px;
    }

    /* Split section */
    .split-card {
        padding: 16px;
        max-width: 100%;
    }

    .split-row {
        grid-template-columns: 1fr 70px 90px 90px; /* narrower columns */
        gap: 6px;
    }

    .split-row input {
        padding: 5px;
        font-size: 13px;
    }

    .split-header {
        font-size: 18px;
    }

    /* Buttons */
    .btn-secondary,
    .btn-primary {
        width: 100%;
        text-align: center;
        padding: 12px;
        font-size: 15px;
        margin-bottom: 12px;
    }

    .btn-primary {
        float: none;
        margin-top: 12px;
    }

    /* Totals */
    .plot-total-box,
    .grand-total-box,
    .final-split-total {
        font-size: 16px;
    }
}

    </style>
</head>

<body>

<header>
    <div class="logo">BrickBook</div>
    <nav>
        <a href="#">Home</a>
        <a href="#">Dashboard</a>
        <a href="#">Logout</a>
    </nav>
</header>

<div class="wrapper">

    <h1>Booking-Off</h1>
    <div class="subtitle">Add your plots and split the wages below.</div>

    <button class="btn-secondary" onclick="addPlot()">+ Add Plot</button>

    <div id="plots-container"></div>

    <div class="grand-total-box">
        Grand Total for All Plots: £<span id="grand-total">0.00</span>
    </div>

    <!-- Squad Split -->
    <div class="split-card">
        <div class="split-header">Squad Split (5 People)</div>

        <div class="split-row" style="font-weight:700;">
            <div>Name</div>
            <div>% Split</div>
            <div>Wages £</div>
            <div>After CIS (80%)</div>
        </div>

        <div id="split-container"></div>

        <div class="final-split-total">
            Total Paid After CIS: £<span id="final-total-cis">0.00</span>
        </div>
    </div>

    <button class="btn-primary" onclick="submitBooking()">Submit Booking-Off</button>

</div>

<script>
    /* CORRECTED CONTRACTOR RATES */
    const measurementTypes = [
        { name: "Bricks", rate: 0.6 },     // £600 per 1000
        { name: "Trench", rate: 25 },
        { name: "100mm", rate: 16 },       // £16 per m2
        { name: "Commons", rate: 0.35 },   // £350 per 1000
        { name: "Squad Hours", rate: 50 }, // £50
        { name: "Lintel", rate: 2 }
    ];

    /* ADD PLOT */
    function addPlot() {
        const container = document.getElementById("plots-container");

        const card = document.createElement("div");
        card.className = "plot-card";

        card.innerHTML = `
            <button class="delete-btn" onclick="deletePlot(this)">X</button>

            <div class="plot-title">
                Plot <input type="text" placeholder="e.g. 44" class="plot-number">
            </div>

            <table>
                <thead>
                    <tr>
                        <th>Measurement</th>
                        <th>Qty</th>
                        <th>Rate (£)</th>
                        <th>Total (£)</th>
                    </tr>
                </thead>
                <tbody>
                    ${measurementTypes.map(m => `
                        <tr>
                            <td>${m.name}</td>
                            <td><input type="number" class="qty" oninput="calcRow(this); calcPlot(this)"></td>
                            <td><input type="number" class="rate" value="${m.rate}" readonly></td>
                            <td><input type="number" class="total" readonly></td>
                        </tr>
                    `).join("")}
                </tbody>
            </table>

            <div class="plot-total-box">
                Plot Total: £<span class="plot-total">0.00</span>
            </div>
        `;

        container.appendChild(card);
    }

    function deletePlot(btn) {
        btn.closest(".plot-card").remove();
        calcGrandTotal();
        calcSplitTotals();
    }

    /* CALC ROW */
    function calcRow(input) {
        const row = input.closest("tr");
        const qty = parseFloat(input.value) || 0;
        const rate = parseFloat(row.querySelector(".rate").value) || 0;
        row.querySelector(".total").value = (qty * rate).toFixed(2);
    }

    /* CALCULATE EACH PLOT */
    function calcPlot(input) {
        const card = input.closest(".plot-card");
        let total = 0;
        card.querySelectorAll(".total").forEach(t => total += parseFloat(t.value) || 0);
        card.querySelector(".plot-total").textContent = total.toFixed(2);
        calcGrandTotal();
        calcSplitTotals();
    }

    /* GRAND TOTAL */
    function calcGrandTotal() {
        let sum = 0;
        document.querySelectorAll(".plot-total").forEach(t => sum += parseFloat(t.textContent) || 0);
        document.getElementById("grand-total").textContent = sum.toFixed(2);
    }

    /* SPLIT SECTION */
    const splitContainer = document.getElementById("split-container");
    for (let i = 0; i < 5; i++) addSplitRow();

    function addSplitRow() {
        const row = document.createElement("div");
        row.className = "split-row";
        row.innerHTML = `
            <input type="text" class="split-name">
            <input type="number" class="split-percent" oninput="percentChanged(this)">
            <input type="number" class="split-wages" oninput="wagesChanged(this)">
            <input type="number" class="split-cis" readonly>
        `;
        splitContainer.appendChild(row);
    }

    /* % changed */
    function percentChanged(input) {
        const row = input.closest(".split-row");
        const percent = parseFloat(input.value) || 0;
        const grand = parseFloat(document.getElementById("grand-total").textContent) || 0;

        const wages = (grand * percent / 100);
        row.querySelector(".split-wages").value = wages.toFixed(2);
        row.querySelector(".split-cis").value = (wages * 0.8).toFixed(2);

        calcSplitTotals();
    }

    /* Wages changed */
    function wagesChanged(input) {
        const row = input.closest(".split-row");
        const wages = parseFloat(input.value) || 0;
        const grand = parseFloat(document.getElementById("grand-total").textContent) || 0;

        if (grand > 0) {
            row.querySelector(".split-percent").value = ((wages / grand) * 100).toFixed(2);
        }

        row.querySelector(".split-cis").value = (wages * 0.8).toFixed(2);
        calcSplitTotals();
    }

    function calcSplitTotals() {
        let totalCIS = 0;
        document.querySelectorAll(".split-cis").forEach(c => totalCIS += parseFloat(c.value) || 0);
        document.getElementById("final-total-cis").textContent = totalCIS.toFixed(2);
    }

    function submitBooking() {
        alert("Booking-Off Complete.");
    }
</script>

</body>
</html>


